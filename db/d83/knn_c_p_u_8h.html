<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>VM2D: VM2D/Wake2D/knnCPU.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/NativeMML"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../LOGO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VM2D
   &#160;<span id="projectnumber">1.12</span>
   </div>
   <div id="projectbrief">Vortex methods for 2D flows simulation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/d83/knn_c_p_u_8h.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">knnCPU.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d8/d19/_vortex2_d_8h_source.html">Vortex2D.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for knnCPU.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/daf/knn_c_p_u_8h__incl.png" border="0" usemap="#_v_m2_d_2_wake2_d_2knn_c_p_u_8h" alt=""/></div>
<map name="_v_m2_d_2_wake2_d_2knn_c_p_u_8h" id="_v_m2_d_2_wake2_d_2knn_c_p_u_8h">
<area shape="rect" id="node2" href="../../d8/d19/_vortex2_d_8h.html" title="Р—Р°РіРѕР»РѕРІРѕС‡РЅС‹Р№ С„Р°Р№Р» СЃ РѕРїРёСЃР°РЅРёРµРј РєР»Р°СЃСЃР° Vortex2D. " alt="" coords="253,80,341,107"/>
<area shape="rect" id="node3" href="../../d9/d27/_point2_d_8h.html" title="Р—Р°РіРѕР»РѕРІРѕС‡РЅС‹Р№ С„Р°Р№Р» СЃ РѕРїРёСЃР°РЅРёРµРј РєР»Р°СЃСЃР° Point2D. " alt="" coords="257,155,337,181"/>
<area shape="rect" id="node4" href="../../df/dc5/numvector_8h.html" title="РћРїРёСЃР°РЅРёРµ РєР»Р°СЃСЃР° numvector. " alt="" coords="250,229,345,256"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d3b/knn_c_p_u_8h__dep__incl.png" border="0" usemap="#_v_m2_d_2_wake2_d_2knn_c_p_u_8hdep" alt=""/></div>
<map name="_v_m2_d_2_wake2_d_2knn_c_p_u_8hdep" id="_v_m2_d_2_wake2_d_2knn_c_p_u_8hdep">
<area shape="rect" id="node2" href="../../d9/d47/knn_c_p_u_8cpp.html" title="VM2D/Wake2D/knnCPU.cpp" alt="" coords="5,80,199,107"/>
<area shape="rect" id="node3" href="../../d8/da3/_wake2_d_8cpp.html" title="Р¤Р°Р№Р» РєРѕРґР° СЃ РѕРїРёСЃР°РЅРёРµРј РєР»Р°СЃСЃР° Wake. " alt="" coords="223,80,418,107"/>
</map>
</div>
</div>
<p><a href="../../db/d83/knn_c_p_u_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a502dc2255024de1a1f2027de5ee9d518"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d83/knn_c_p_u_8h.html#a502dc2255024de1a1f2027de5ee9d518">WakekNN</a> (const std::vector&lt; <a class="el" href="../../d0/de1/class_v_mlib_1_1_vortex2_d.html">Vortex2D</a> &gt; &amp;vtx, const size_t k, std::vector&lt; std::vector&lt; std::pair&lt; double, size_t &gt;&gt;&gt; &amp;initdist)</td></tr>
<tr class="separator:a502dc2255024de1a1f2027de5ee9d518"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a502dc2255024de1a1f2027de5ee9d518"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WakekNN </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d0/de1/class_v_mlib_1_1_vortex2_d.html">Vortex2D</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; double, size_t &gt;&gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>initdist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d47/knn_c_p_u_8cpp_source.html#l00447">447</a> of file <a class="el" href="../../d9/d47/knn_c_p_u_8cpp_source.html">knnCPU.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                                                                                                      {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> n = vtx.size();</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">auto</span> gab = <a class="code" href="../../d9/d47/knn_c_p_u_8cpp.html#a59b87bc33ee5fea4761b3d784a08dbd4">GetGabarit</a>(vtx);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordtype">double</span> scale = std::max(gab.second[0] - gab.first[0], gab.second[1] - gab.first[1]);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//создание единого массива data и query </span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    std::vector&lt;TParticleCode&gt; mortonCodeBoth(2 * vtx.size());</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">//сортировка единого массива (data и query) по мортоновским кодам    std::vector&lt;TParticleCode&gt; mortonCodeBoth_temp(2 * vtx.size());

    //для каждого запроса запоминаем индекс iq -- индекс ближайшего левого элемента данных
    //отсортиванный массив mortonCodeBoth разделяем на mcquery (только запросы) и mcdata (только данные)
    std::vector&lt;TParticleCode&gt; mcdata, mcquery;

    std::vector&lt;unsigned int&gt; iq;


    //поиск для каждого запроса k точек данных слева и k точек данных справа (при нехватке данных с одной стороны, добавляем с другой)
    //для каждого запроса находим индекс элемента данных, с которого будут отсчитываться 2*k соседей
    std::vector&lt;size_t&gt; initneig(vtx.size(), -1);

    //выбор из 2*k кандидатов k соседей (выбор по расстоянию от данных до запроса)
    // initdist = {расстояние; до элемента данных}
    // сортировка по расстоянию
    /*std::vector &lt; std::vector &lt; std::pair&lt;double, size_t&gt; &gt;&gt; initdist(vtx.size());
    for (auto&amp; d : initdist)
        d.resize(2 * k, { -1.0, -1 });*/

        //Сдвигаем все точки
    double t1 = omp_get_wtime();
    double tStart[5], tFinish[5];
    double time[5][8];
    for (size_t sdvig = 0; sdvig &lt;= 4; ++sdvig) //4
    {

        tStart[sdvig] = omp_get_wtime();
        mainCycle((int)k, vtx, gab, scale, (int)sdvig,
            mortonCodeBoth,
            s, mortonCodeBoth_temp, mcdata, mcquery,
            iq, initneig, initdist, time[sdvig]);
        tFinish[sdvig] = omp_get_wtime();

        //std::cout &lt;&lt; &quot;time_knn:&quot; 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][1] - time[sdvig][0] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][2] - time[sdvig][1] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][3] - time[sdvig][2] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][4] - time[sdvig][3] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][5] - time[sdvig][4] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][6] - time[sdvig][5] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][7] - time[sdvig][6] &lt;&lt; std::endl;
    }//for sdvig
}</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    std::vector&lt;unsigned int&gt; s(256 * omp_get_max_threads());</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    std::vector&lt;TParticleCode&gt; mortonCodeBoth_temp(2 * vtx.size());</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">//для каждого запроса запоминаем индекс iq -- индекс ближайшего левого элемента данных</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//отсортиванный массив mortonCodeBoth разделяем на mcquery (только запросы) и mcdata (только данные)</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    std::vector&lt;TParticleCode&gt; mcdata, mcquery;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    std::vector&lt;unsigned int&gt; iq;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">//поиск для каждого запроса k точек данных слева и k точек данных справа (при нехватке данных с одной стороны, добавляем с другой)</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">//для каждого запроса находим индекс элемента данных, с которого будут отсчитываться 2*k соседей
    //выбор из 2*k кандидатов k соседей (выбор по расстоянию от данных до запроса)
    // initdist = {расстояние; до элемента данных}
    // сортировка по расстоянию
    /*std::vector &lt; std::vector &lt; std::pair&lt;double, size_t&gt; &gt;&gt; initdist(vtx.size());
    for (auto&amp; d : initdist)
        d.resize(2 * k, { -1.0, -1 });*/

        //Сдвигаем все точки
    double t1 = omp_get_wtime();
    double tStart[5], tFinish[5];
    double time[5][8];
    for (size_t sdvig = 0; sdvig &lt;= 4; ++sdvig) //4
    {

        tStart[sdvig] = omp_get_wtime();
        mainCycle((int)k, vtx, gab, scale, (int)sdvig,
            mortonCodeBoth,
            s, mortonCodeBoth_temp, mcdata, mcquery,
            iq, initneig, initdist, time[sdvig]);
        tFinish[sdvig] = omp_get_wtime();

        //std::cout &lt;&lt; &quot;time_knn:&quot; 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][1] - time[sdvig][0] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][2] - time[sdvig][1] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][3] - time[sdvig][2] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][4] - time[sdvig][3] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][5] - time[sdvig][4] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][6] - time[sdvig][5] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][7] - time[sdvig][6] &lt;&lt; std::endl;
    }//for sdvig
}</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    std::vector&lt;size_t&gt; initneig(vtx.size(), -1);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">//выбор из 2*k кандидатов k соседей (выбор по расстоянию от данных до запроса)</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// initdist = {расстояние; до элемента данных}</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// сортировка по расстоянию</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">/*std::vector &lt; std::vector &lt; std::pair&lt;double, size_t&gt; &gt;&gt; initdist(vtx.size());</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">    for (auto&amp; d : initdist)</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">        d.resize(2 * k, { -1.0, -1 });*/</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">//Сдвигаем все точки    double tStart[5], tFinish[5];
    double time[5][8];
    for (size_t sdvig = 0; sdvig &lt;= 4; ++sdvig) //4
    {

        tStart[sdvig] = omp_get_wtime();
        mainCycle((int)k, vtx, gab, scale, (int)sdvig,
            mortonCodeBoth,
            s, mortonCodeBoth_temp, mcdata, mcquery,
            iq, initneig, initdist, time[sdvig]);
        tFinish[sdvig] = omp_get_wtime();

        //std::cout &lt;&lt; &quot;time_knn:&quot; 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][1] - time[sdvig][0] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][2] - time[sdvig][1] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][3] - time[sdvig][2] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][4] - time[sdvig][3] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][5] - time[sdvig][4] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][6] - time[sdvig][5] 
        //  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][7] - time[sdvig][6] &lt;&lt; std::endl;
    }//for sdvig
}</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">double</span> t1 = omp_get_wtime();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">double</span> tStart[5], tFinish[5];</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">double</span> time[5][8];</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> sdvig = 0; sdvig &lt;= 4; ++sdvig) <span class="comment">//4</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        tStart[sdvig] = omp_get_wtime();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="../../d9/d47/knn_c_p_u_8cpp.html#a3aa4d7d06eebd51153b1e88b6cdfed72">mainCycle</a>((<span class="keywordtype">int</span>)k, vtx, gab, scale, (<span class="keywordtype">int</span>)sdvig,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            mortonCodeBoth,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            s, mortonCodeBoth_temp, mcdata, mcquery,</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            iq, initneig, initdist, time[sdvig]);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        tFinish[sdvig] = omp_get_wtime();</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;time_knn:&quot; </span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][1] - time[sdvig][0] </span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][2] - time[sdvig][1] </span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][3] - time[sdvig][2] </span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][4] - time[sdvig][3] </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][5] - time[sdvig][4] </span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][6] - time[sdvig][5] </span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">//  &lt;&lt; &quot; &quot; &lt;&lt; time[sdvig][7] - time[sdvig][6] &lt;&lt; std::endl;</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }<span class="comment">//for sdvig</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}<div class="ttc" id="knn_c_p_u_8cpp_html_a3aa4d7d06eebd51153b1e88b6cdfed72"><div class="ttname"><a href="../../d9/d47/knn_c_p_u_8cpp.html#a3aa4d7d06eebd51153b1e88b6cdfed72">mainCycle</a></div><div class="ttdeci">void mainCycle(const int k, const std::vector&lt; Vortex2D &gt; &amp;vtx, const std::pair&lt; Point2D, Point2D &gt; &amp;gab, const double scale, const int sdvig, std::vector&lt; TParticleCode &gt; &amp;mortonCodeBoth, std::vector&lt; unsigned int &gt; &amp;s, std::vector&lt; TParticleCode &gt; &amp;mortonCodeBoth_temp, std::vector&lt; TParticleCode &gt; &amp;mcdata, std::vector&lt; TParticleCode &gt; &amp;mcquery, std::vector&lt; unsigned int &gt; &amp;iq, std::vector&lt; size_t &gt; &amp;initneig, std::vector&lt; std::vector&lt; std::pair&lt; double, size_t &gt;&gt;&gt; &amp;initdist, double *time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d47/knn_c_p_u_8cpp_source.html#l00264">knnCPU.cpp:264</a></div></div>
<div class="ttc" id="knn_c_p_u_8cpp_html_a59b87bc33ee5fea4761b3d784a08dbd4"><div class="ttname"><a href="../../d9/d47/knn_c_p_u_8cpp.html#a59b87bc33ee5fea4761b3d784a08dbd4">GetGabarit</a></div><div class="ttdeci">std::pair&lt; Point2D, Point2D &gt; GetGabarit(const std::vector&lt; Vortex2D &gt; &amp;vtx)</div><div class="ttdoc">Поиск границ габаритного прямоугольника (левый нижний и правый верхний) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d47/knn_c_p_u_8cpp_source.html#l00013">knnCPU.cpp:13</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_cgraph.png" border="0" usemap="#db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_cgraph" alt=""/></div>
<map name="db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_cgraph" id="db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_cgraph">
<area shape="rect" id="node2" href="../../d9/d47/knn_c_p_u_8cpp.html#a59b87bc33ee5fea4761b3d784a08dbd4" title="Поиск границ габаритного прямоугольника (левый нижний и правый верхний) " alt="" coords="136,31,221,57"/>
<area shape="rect" id="node4" href="../../d9/d47/knn_c_p_u_8cpp.html#a3aa4d7d06eebd51153b1e88b6cdfed72" title="mainCycle" alt="" coords="137,132,221,159"/>
<area shape="rect" id="node3" href="../../d0/de1/class_v_mlib_1_1_vortex2_d.html#afb7db6466df1b93954f3a00610a05d0b" title="Р¤СѓРЅРєС†РёСЏ РґР»СЏ РґРѕСЃС‚СѓРїР° Рє СЂР°РґРёСѓСЃ&#45;РІРµРєС‚РѕСЂСѓ РІРёС…СЂСЏ " alt="" coords="269,5,400,32"/>
<area shape="rect" id="node5" href="../../d9/d47/knn_c_p_u_8cpp.html#a8f03a33b2fc5c0cc9815ad1624362a4b" title="Morton2D" alt="" coords="295,56,374,83"/>
<area shape="rect" id="node7" href="../../d9/d47/knn_c_p_u_8cpp.html#acc7e6b44c7539afc6733395e7bb43a7e" title="Сортировка массива из мортоновский кодов " alt="" coords="281,107,388,133"/>
<area shape="rect" id="node8" href="../../dd/d9a/namespace_v_mlib.html#a4707de62176aa2068f1f8628e0460f8c" title="Р’С‹С‡РёСЃР»РµРЅРёРµ СЂР°СЃСЃС‚РѕСЏРЅРёСЏ РјРµР¶РґСѓ РґРІСѓРјСЏ С‚РѕС‡РєР°РјРё " alt="" coords="293,157,377,184"/>
<area shape="rect" id="node9" href="../../d9/d47/knn_c_p_u_8cpp.html#a7c3f80cac72e3ecd204fdb25e391649c" title="newSort" alt="" coords="299,208,370,235"/>
<area shape="rect" id="node10" href="../../d9/d47/knn_c_p_u_8cpp.html#aa477c444567c6ebae8f1dc2db478586c" title="newMerge" alt="" coords="293,259,376,285"/>
<area shape="rect" id="node6" href="../../d9/d47/knn_c_p_u_8cpp.html#ad0e1490b213053387b10e0bcf55dc2e7" title="ExpandBits" alt="" coords="448,56,537,83"/>
<area shape="rect" id="node11" href="../../d9/d47/knn_c_p_u_8cpp.html#a8b46f9f925a7cbc80c50760a64378f64" title="BinSearch" alt="" coords="451,259,534,285"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_icgraph.png" border="0" usemap="#db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_icgraph" alt=""/></div>
<map name="db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_icgraph" id="db/d83/knn_c_p_u_8h_a502dc2255024de1a1f2027de5ee9d518_icgraph">
<area shape="rect" id="node2" href="../../df/d8f/class_v_m2_d_1_1_wake.html#a80d90185d437e1691ef3e827a830b3b3" title="Р РµСЃС‚СЂСѓРєС‚СѓСЂРёР·Р°С†РёСЏ РІРёС…СЂРµРІРѕРіРѕ СЃР»РµРґР° " alt="" coords="136,5,295,32"/>
<area shape="rect" id="node3" href="../../df/d8f/class_v_m2_d_1_1_wake.html#a8445ca23e13732c4b7aa312c4e2c219d" title="Р”РµСЃС‚СЂСѓРєС‚РѕСЂ " alt="" coords="343,5,493,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_6fafd8481eb09d016152358e536fd7b4.html">VM2D</a></li><li class="navelem"><a class="el" href="../../dir_0c8359f514b94cebc4ce1d17b7c98a58.html">Wake2D</a></li><li class="navelem"><a class="el" href="../../db/d83/knn_c_p_u_8h.html">knnCPU.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
